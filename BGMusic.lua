local song = {
  default = {
    path = "Interface\\AddOns\\BGMusic\\Tearing_Through_Heaven.mp3",
    duration = 131
  },
  boss = {
    -- df sigle raid boss
    eranog = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    consejo_primigenio = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    sennarth_aliento_gelido = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    kurog_totem_siniestro = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    raszageth_devoratormentas = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    vigilante_diurna = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    dathea_ascendida = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    terros = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    -- df single dungeon boss
    
    leymor = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    telash_vientogris = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    umbrelskul = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    hojazur = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    
    balakar_khan = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    teera_y_maruuk = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    la_tempestad_iracunda = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    granyth = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    
    colmimagma = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    senyora_guerra_sargha = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    maestro_forja_gorek = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    magmat_azote_escamas = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    
    tiravisceras = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    faucefronda = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    matriarca_descomposici√≥n_ojofurioso = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    banda_guerra_hachagarra = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    
    kokia_pezunya_ardiente = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    melidrussa_tejescarcha = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    kyrakka_y_erkhart_sangre_tormentosa = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    
    vexamus = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    anciano_sin_podar = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    graznat = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    eco_de_doragosa = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    
    vigia_irideus = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    goliat_tragon = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    khajin_la_implacable = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    tsunami_primigenio = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    
    enanos_desaparecidos = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    bromach = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    centinela_talondras = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    emberon = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    cronolord_deios = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    
    -- sl single raid boss
    guardian_vigilante = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    dausegne_oraculo_caida = {
      path = "Interface\\AddOns\\BGMusic\\Maximum_Corruption.ogg",
      duration = 371
    },
    artificiero_xymox = {
      path = "Interface\\AddOns\\BGMusic\\Nightmare_DoReMi_v2.ogg",
      duration = 313
    },
    panteon_prototipo = {
      path = "Interface\\AddOns\\BGMusic\\Claude_endgame.ogg",
      duration = 480
    },
    skolex_devorador_insaciable = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },
    halondrus_recolector = {
      path = "Interface\\AddOns\\BGMusic\\Rules_of_Nature.ogg",
      duration = 458
    },
    lihuvim_arquitecto_principal = {
      path = "Interface\\AddOns\\BGMusic\\Nightmare_DoReMi_v2.ogg",
      duration = 313
    },
    anduin_wrynn = {
      path = "Interface\\AddOns\\BGMusic\\THE_RUMBLING.ogg",
      duration = 348
    },
    senyores_terror = {
      path = "Interface\\AddOns\\BGMusic\\Insidious.ogg",
      duration = 342
    },
    rygelon = {
      path = "Interface\\AddOns\\BGMusic\\The_Greatest_Jubilee_LaMi.ogg",
      duration = 420
    },
    carcelero = {
      path = "Interface\\AddOns\\BGMusic\\Apex_of_the_world.ogg",
      duration = 525
    },
    
    -- sl single dungeon boss
    oasis_myza = {
      path = "Interface\\AddOns\\BGMusic\\WILDSIDE.ogg",
      duration = 227
    },
    soazmi = {
      path = "Interface\\AddOns\\BGMusic\\Showdown_With_Fury_Bowser.ogg",
      duration = 192
    },
    hylbrande = {
      path = "Interface\\AddOns\\BGMusic\\Showdown_With_Fury_Bowser.ogg",
      duration = 192
    },
    capitana_colagarfio = {
      path = "Interface\\AddOns\\BGMusic\\Showdown_With_Fury_Bowser.ogg",
      duration = 192
    },
    soleah = {
      path = "Interface\\AddOns\\BGMusic\\Beyond_Time.ogg",
      duration = 392
    },

    -- bfa single raid boss 
    jaina = {
      path = "Interface\\AddOns\\BGMusic\\Let-It-Go-Winter.mp3",
      duration = 229
    },
    
    -- bfa single dungeon boss
    sethraliss = {
      path = "Interface\\AddOns\\BGMusic\\bioinformatics.mp3",
      duration = 128
    },
    
    -- legion single dungeon boss
    cordana = {
      path = "Interface\\AddOns\\BGMusic\\moon_river.mp3",
      duration = 510
    },
    
    archidruida_glaidalis = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    corazon_de_roble = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    dresaron = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    sombra_de_xavius = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    
    hymdall = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    hyrja = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    fenryr = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    rey_divino_skovald = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    odyn_salones = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    
    capitan_patrulla_gerdo = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    talixae_corona_fuego = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    consejero_melandrus = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    
    -- wod single raid boss
    -- wod single dungeon boss
    sadana_furia_sangrienta = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    quijahueso = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    ner_zhul_cementerio = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    nhallish = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },

    -- mists single raid boss
    -- mists single dungeon boss
    liu_corazon_llameante = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    eremita_senda_petrea = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    maro_el_sabio = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    sha_de_la_duda = {
      path = "Interface\\AddOns\\BGMusic\\arboleda_corazon_oscuro.mp3",
      duration = 139
    },
    -------------------------------------------------------------------------------------
    
    -- df dungeon boss
    boveda_azur = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    ataque_nokhud = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    neltharus = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    hondonada_frondacuero = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    estanques_vida_rubi = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    academia_algethar = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    salas_de_infusion = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    uldaman_legado_tyr = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    -- df raid boss
    boveda_encarnaciones = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },

    -- sl dungeon boss
    teatro_dolor = {
      path = "Interface\\AddOns\\BGMusic\\The_Verge_of_Death_(Rain).mp3",
      duration = 171
    },
    peste_abrumadora = {
      path = "Interface\\AddOns\\BGMusic\\The_Verge_of_Death_(Rain).mp3",
      duration = 171
    },
    destruccion_necrotica = {
      path = "Interface\\AddOns\\BGMusic\\Koloktos_Moldarach.mp3",
      duration = 161
    },
    profundidades_sanguineas = {
      path = "Interface\\AddOns\\BGMusic\\Lost_Again.mp3",
      duration = 310
    },
    salones_expiacion = {
      path = "Interface\\AddOns\\BGMusic\\Lost_Again.mp3",
      duration = 310
    },
    torres_ascencion = {
      path = "Interface\\AddOns\\BGMusic\\Koloktos_Moldarach.mp3",
      duration = 161
    },
    tirna_scithe = {
      path = "Interface\\AddOns\\BGMusic\\Decisive_Battle_I.mp3",
      duration = 266
    },
    el_otro_lado = {
      path = "Interface\\AddOns\\BGMusic\\Where_Is_Your_God_Now.mp3",
      duration = 109
    },
    torghast = {
      path = "Interface\\AddOns\\BGMusic\\therion-blood-of-kingu.mp3",
      duration = 332
    },
    tazavesh = {
      path = "Interface\\AddOns\\BGMusic\\11_Bowsers_Fury.mp3",
      duration = 232
    },
    -- sl raid boss
    castillo_nathria = {
      path = "Interface\\AddOns\\BGMusic\\Raid.mp3",
      duration = 216
    },
    sagrario_dominacion = {
      path = "Interface\\AddOns\\BGMusic\\08_minos.mp3",
      duration = 116
    },
    sepulcro_primeros = {
      path = "Interface\\AddOns\\BGMusic\\vorash_smash.ogg",
      duration = 336
    },

    --bfa dungeon boss
    mansion_tarjasenda = {
      path = "Interface\\AddOns\\BGMusic\\song(xepher).mp3",
      duration = 216
    },
    filon = {
      path = "Interface\\AddOns\\BGMusic\\l4d_concert.mp3",
      duration = 265
    },
    templo_sethraliss = {
      path = "Interface\\AddOns\\BGMusic\\bioinformatics.mp3",
      duration = 128
    },
    bardoma = {
      path = "Interface\\AddOns\\BGMusic\\windowless_building.mp3",
      duration = 260
    },
    puerto_libre = {
      path = "Interface\\AddOns\\BGMusic\\Lets_Battle_Mix.mp3",
      duration = 245
    },
    santuario_tormenta = {
      path = "Interface\\AddOns\\BGMusic\\underground_cave.mp3",
      duration = 153
    },
    
    --bfa raid boss
    dazaralor = {
      path = "Interface\\AddOns\\BGMusic\\full_circle.mp3",
      duration = 85
    },

    -- legion dungeon
    salones_del_valor = {
      path = "Interface\\AddOns\\BGMusic\\full_circle.mp3",
      duration = 85
    },
    corte_de_estrellas = {
      path = "Interface\\AddOns\\BGMusic\\full_circle.mp3",
      duration = 85
    },
    -- legion raid

    -- wod dungeon
    cementerios_sombraluna = {
      path = "Interface\\AddOns\\BGMusic\\full_circle.mp3",
      duration = 85
    },
    -- wod raid

    -- mists dungeon
    templo_dragon_jade = {
      path = "Interface\\AddOns\\BGMusic\\full_circle.mp3",
      duration = 85
    },
    -- mists raid

    -------------------------------------------------------------------------------------
    default_boss = {
      path = "Interface\\AddOns\\BGMusic\\bosses.mp3",
      duration = 103
    }
  },
  instance = {
    -- df dungeon
    boveda_azur = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    ataque_nokhud = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    neltharus = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    hondonada_frondacuero = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    estanques_vida_rubi = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    academia_algethar = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    salas_de_infusion = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    uldaman_legado_tyr = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    -- df raid
    boveda_encarnaciones = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    
    -- sl dungeon
    teatro_dolor = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    peste_abrumadora = {
      path = "Interface\\AddOns\\BGMusic\\Shambhala_(Thunder).mp3",
      duration = 189
    },
    destruccion_necrotica = {
      path = "Interface\\AddOns\\BGMusic\\The_Shackled_Wolves_(Rain).mp3",
      duration = 353
    },
    profundidades_sanguineas = {
      path = "Interface\\AddOns\\BGMusic\\Wine_Of_Aluqah.mp3",
      duration = 282
    },
    salones_expiacion = {
      path = "Interface\\AddOns\\BGMusic\\Wine_Of_Aluqah.mp3",
      duration = 282
    },
    torres_ascencion = {
      path = "Interface\\AddOns\\BGMusic\\Tempest_of_Seasons_(Rain).mp3",
      duration = 307
    },
    tirna_scithe = {
      path = "Interface\\AddOns\\BGMusic\\Dwellings_of_the_Ancient_Gods.ogg",
      duration = 296
    },
    el_otro_lado = {
      path = "Interface\\AddOns\\BGMusic\\Adrian_von_Ziegler_-_Spirit_War.ogg",
      duration = 198
    },
    torghast = {
      path = "Interface\\AddOns\\BGMusic\\therion-blood-of-kingu.mp3",
      duration = 332
    },
    tazavesh = {
      path = "Interface\\AddOns\\BGMusic\\Aruh_Metal_Slug_X_Judgement.mp3",
      duration = 162
    },
    
    -- sl raid
    castillo_nathria = {
      path = "Interface\\AddOns\\BGMusic\\At_What_Cost_(Rain).mp3",
      duration = 349
    },
    sagrario_dominacion = {
      path = "Interface\\AddOns\\BGMusic\\04_dante_casarma_treloch.mp3",
      duration = 88
    }, 
    sepulcro_primeros = {
      path = "Interface\\AddOns\\BGMusic\\VS_Serris_-_Metroid_Dread.ogg",
      duration = 241
    },
  
    -- bfa dungeon
    mansion_tarjasenda = {
      path = "Interface\\AddOns\\BGMusic\\mansion_tarjasenda.mp3",
      duration = 143
    },
    filon = {
      path = "Interface\\AddOns\\BGMusic\\lili_club.mp3",
      duration = 271
    },
    templo_sethraliss = {
      path = "Interface\\AddOns\\BGMusic\\bacterion.mp3",
      duration = 106
    },
    bardoma = {
      path = "Interface\\AddOns\\BGMusic\\cenotaph.mp3",
      duration = 119
    },
    puerto_libre = {
      path = "Interface\\AddOns\\BGMusic\\Karakuri_Defense_System_Activate.mp3",
      duration = 204
    },
    santuario_tormenta = {
      path = "Interface\\AddOns\\BGMusic\\windowless_building.mp3",
      duration = 260
    },
    
    -- bfa raid
    dazaralor = {
      path = "Interface\\AddOns\\BGMusic\\battle_lusamine.mp3",
      duration = 179
    },
    
    -- legion dungeon
    salones_del_valor = {
      path = "Interface\\AddOns\\BGMusic\\battle_lusamine.mp3",
      duration = 179
    },
    corte_de_estrellas = {
      path = "Interface\\AddOns\\BGMusic\\battle_lusamine.mp3",
      duration = 179
    },
    -- legion raid

    -- wod dungeon
    cementerios_sombraluna = {
      path = "Interface\\AddOns\\BGMusic\\battle_lusamine.mp3",
      duration = 179
    },
    -- wod raid

    -- mists dungeon
    templo_dragon_jade = {
      path = "Interface\\AddOns\\BGMusic\\battle_lusamine.mp3",
      duration = 179
    },
    -- mists raid
  }
}

local boss = {
  -- df single raid boss
  eranog = {
    npc_id = 184972,
    encounterID = 2587
  },
  consejo_primigenio = {
    npc_id = 187771,
    encounterID = 2590
  },
  sennarth_aliento_gelido = {
    npc_id = 187771,
    encounterID = 2592
  },
  kurog_totem_siniestro = {
    npc_id = 184686,
    encounterID = 2605
  },
  raszageth_devoratormentas = {
    npc_id = 187771,
    encounterID = 2607
  },
  vigilante_diurna = {
    npc_id = 190245,
    encounterID = 2614
  },
  dathea_ascendida = {
    npc_id = 189813,
    encounterID = 2635
  },
  terros = {
    npc_id = 190496,
    encounterID = 2639
  },

  -- df single dungeon boss
  leymor = {
    npc_id = 186644,
    encounterID = 2582
  },
  telash_vientogris = {
    npc_id = 197025,
    encounterID = 2583
  },
  umbrelskul = {
    npc_id = 186738,
    encounterID = 2584
  },
  hojazur = {
    npc_id = 186739,
    encounterID = 2585
  },

  balakar_khan = {
    npc_id = 186151,
    encounterID = 2580
  },
  teera_y_maruuk = {
    npc_id = 195723,
    encounterID = 2581
  },
  la_tempestad_iracunda = {
    npc_id = 186615,
    encounterID = 2636
  },
  granyth = {
    npc_id = 186616,
    encounterID = 2637
  },

  colmimagma = {
    npc_id = 181861,
    encounterID = 2610
  },
  senyora_guerra_sargha = {
    npc_id = 189901,
    encounterID = 2611
  },
  maestro_forja_gorek = {
    npc_id = 189478,
    encounterID = 2612
  },
  magmat_azote_escamas = {
    npc_id = 189340,
    encounterID = 2613
  },

  tiravisceras = {
    npc_id = 186116,
    encounterID = 2567
  },
  faucefronda = {
    npc_id = 186120,
    encounterID = 2568
  },
  matriarca_descomposici√≥n_ojofurioso = {
    npc_id = 186121,
    encounterID = 2569
  },
  banda_guerra_hachagarra = {
    npc_id = 186122,
    encounterID = 2570
  },

  kokia_pezunya_ardiente = {
    npc_id = 189232,
    encounterID = 2606
  },
  melidrussa_tejescarcha = {
    npc_id = 188252,
    encounterID = 2609
  },
  kyrakka_y_erkhart_sangre_tormentosa = {
    npc_id = 193435,
    encounterID = 2623
  },

  vexamus = {
    npc_id = 194181,
    encounterID = 2562
  },
  anciano_sin_podar = {
    npc_id = 196482,
    encounterID = 2563
  },
  graznat = {
    npc_id = 191736,
    encounterID = 2564
  },
  eco_de_doragosa = {
    npc_id = 190609,
    encounterID = 2565
  },

  vigia_irideus = {
    npc_id = 189719,
    encounterID = 2615
  },
  goliat_tragon = {
    npc_id = 195399,
    encounterID = 2616
  },
  khajin_la_implacable = {
    npc_id = 189727,
    encounterID = 2617
  },
  tsunami_primigenio = {
    npc_id = 189729,
    encounterID = 2618
  },

  enanos_desaparecidos = {
    npc_id = 6906,
    encounterID = 2555
  },
  bromach = {
    npc_id = 184018,
    encounterID = 2556
  },
  centinela_talondras = {
    npc_id = 184124,
    encounterID = 2557
  },
  emberon = {
    npc_id = 184422,
    encounterID = 2558
  },
  cronolord_deios = {
    npc_id = 184125,
    encounterID = 2559
  },

  -- sl single raid boss
  guardian_vigilante = {
    npc_id = 180773,
    encounterID = 2512
  },
  dausegne_oraculo_caida = {
    npc_id = 181224,
    encounterID = 2540
  },
  artificiero_xymox = {
    npc_id = 183501,
    encounterID = 2553
  },
  panteon_prototipo = {
    npc_id = 181549,
    encounterID = 2544
  },
  skolex_devorador_insaciable = {
    npc_id = 183937,
    encounterID = 2542
  },
  halondrus_recolector = {
    npc_id = 184915,
    encounterID = 2529
  },
  lihuvim_arquitecto_principal = {
    npc_id = 182169,
    encounterID = 2539
  },
  anduin_wrynn = {
    npc_id = 181954,
    encounterID = 2546
  },
  senyores_terror = {
    npc_id = 26533,
    encounterID = 2543
  },
  rygelon = {
    npc_id = 182777,
    encounterID = 2549
  },
  carcelero = {
    npc_id = 185421,
    encounterID = 2537
  },

  -- sl single dungeon boss
  soleah = {
    npc_id = 180863,
    encounterID = 2442
  },
  capitana_colagarfio = {
    npc_id = 175546,
    encounterID = 2419
  },
  hylbrande = {
    npc_id = 175663,
    encounterID = 2426
  },
  soazmi = {
    npc_id = 175806,
    encounterID = 2437
  },
  oasis_myza = {
    npc_id = 176564,
    encounterID = 2440
  },

  -- bfa single raid boss
  jaina = {
    npc_id = 149684,
    encounterID = 2281
  },

  -- bfa single dungeon boss
  sethraliss = {
    npc_id = 133392,
    encounterID = 2127
  },

  -- legion single raid boss
  -- legion single dungeon boss
  cordana = {
    npc_id = 95888,
    encounterID = 1818
  },

  archidruida_glaidalis = {
    npc_id = 96512,
    encounterID = 1836
  },
  corazon_de_roble = {
    npc_id = 103344,
    encounterID = 1837
  },
  dresaron = {
    npc_id = 99200,
    encounterID = 1838
  },
  sombra_de_xavius = {
    npc_id = 99192,
    encounterID = 1839
  },

  hymdall = {
    npc_id = 94960,
    encounterID = 1805
  },
  hyrja = {
    npc_id = 95833,
    encounterID = 1806
  },
  fenryr = {
    npc_id = 99868,
    encounterID = 1807
  },
  rey_divino_skovald = {
    npc_id = 95675,
    encounterID = 1808
  },
  odyn_salones = {
    npc_id = 95676,
    encounterID = 1809
  },
  
  capitan_patrulla_gerdo = {
    npc_id = 104215,
    encounterID = 1868
  },
  talixae_corona_fuego = {
    npc_id = 104217,
    encounterID = 1869
  },
  consejero_melandrus = {
    npc_id = 101831,
    encounterID = 1870
  },

  -- wod single raid boss
  -- wod single dungeon boss
  sadana_furia_sangrienta = {
    npc_id = 75509,
    encounterID = 1677
  },
  quijahueso = {
    npc_id = 75452,
    encounterID = 1679
  },
  ner_zhul_cementerio = {
    npc_id = 76407,
    encounterID = 1682
  },
  nhallish = {
    npc_id = 75829,
    encounterID = 1688
  },

  -- mists single raid boss
  -- mists single dungeon boss
  liu_corazon_llameante = {
    npc_id = 56732,
    encounterID = 1416
  },
  eremita_senda_petrea = {
    npc_id = 56843,
    encounterID = 1417
  },
  maro_el_sabio = {
    npc_id = 56448,
    encounterID = 1418
  },
  sha_de_la_duda = {
    npc_id = 56439,
    encounterID = 1439
  }
}

local instance = {
  -- df dungeon
  boveda_azur = {
    instanceID = 2515
  },
  ataque_nokhud = {
    instanceID = 2516
  },
  neltharus = {
    instanceID = 2519
  },
  hondonada_frondacuero = {
    instanceID = 2520
  },
  estanques_vida_rubi = {
    instanceID = 2521
  },
  academia_algethar = {
    instanceID = 2526
  },
  salas_de_infusion = {
    instanceID = 2527
  },
  uldaman_legado_tyr = {
    instanceID = 2451
  },
  -- df raid
  boveda_encarnaciones = {
    instanceID = 2522
  },
  
  -- sl dungeon
  teatro_dolor = {
    instanceID = 2293
  },
  peste_abrumadora = {
    instanceID = 2289
  },
  destruccion_necrotica = {
    instanceID = 2286
  },
  profundidades_sanguineas = {
    instanceID = 2284
  },
  salones_expiacion = {
    instanceID = 2287
  },
  torres_ascencion = {
    instanceID = 2285
  },
  el_otro_lado = {
    instanceID = 2291
  },
  tirna_scithe = {
    instanceID = 2290
  },
  torghast = {
    instanceID = 2162
  },
  tazavesh = {
    instanceID = 2441
  },
  
  -- sl raid
  castillo_nathria = {
    instanceID = 2296
  },
  sagrario_dominacion = {
    instanceID = 2450
  },
  sepulcro_primeros = {
    instanceID = 2481
  },
  
  -- bfa dungeon
  ataldazar = {
    instanceID = 1763
  },
  puerto_libre = {
    instanceID = 1754
  },
  descanso_reyes = {
    instanceID = 1762
  },
  santuario_tormenta = {
    instanceID = 1864
  },
  boralus = {
    instanceID = 1822
  },
  templo_sethraliss = {
    instanceID = 1877
  },
  filon = {
    instanceID = 1594
  },
  bardoma = {
    instanceID = 1841
  },
  mansion_tarjasenda = {
    instanceID = 1862
  },
  
  -- bfa raid
  uldir = {
    instanceID = 1861
  },
  dazaralor = {
    instanceID = 2070
  },
  
  -- legion dungeon
  salones_del_valor = {
    instanceID = 1477
  },
  corte_de_estrellas = {
    instanceID = 1571
  },
  -- legion raid

  -- wod dungeon
  cementerios_sombraluna = {
    instanceID = 1176
  },
  -- wod raid

  -- mists dungeon
  templo_dragon_jade = {
    instanceID = 960
  }
  -- mists raid
}

local friend_units = {
  "player",
  "party1",
  "party2",
  "party3",
  "party4",
  "party5"
}
local is_played = nil
local id_handler = nil
local current_playing = false
local current_song = {
  path = nil,
  duration = 0
}
local time_now = nil
local on_battle = false
local boss_fight = false
local id_fight_encounter = nil
local battle_music, battle_events = CreateFrame("Frame"), {}

battle_music:SetScript("OnEvent", function(self, event, ...)
  battle_events[event](self, ...)
end)

function battle_events:PLAYER_REGEN_DISABLED(event)
  print("PLAYER_REGEN_DISABLED")
  on_battle = true
  if current_playing == true then
    if id_handler ~= nil then
      StopSound(id_handler)
      current_playing = false
      current_song.path = nil
      current_song.duration = 0
    end
  end
  selecting_song()
end

function battle_events:ENCOUNTER_START(encounterID, name, difficulty, size)
  print("ENCOUNTER_START ", encounterID, name, difficulty, size)
  boss_fight = true
  on_battle = true
  id_fight_encounter = tonumber(encounterID)
  if current_playing == true then
    if id_handler ~= nil then
      StopSound(id_handler)
      current_playing = false
      current_song.path = nil
      current_song.duration = 0
    end
  end
  selecting_song()
end

function battle_events:PLAYER_REGEN_ENABLED(event)
  print("PLAYER_REGEN_ENABLED")
  on_battle = false
  id_fight_encounter = nil
  if current_playing == true then
    if id_handler ~= nil then
      StopSound(id_handler)
      current_playing = false
      current_song.path = nil
      current_song.duration = 0
    end
  end
end

function battle_events:ENCOUNTER_END(encounterID, name, difficulty, size, success)
  print("ENCOUNTER_END ", encounterID, name, difficulty, size, success)
  boss_fight = false
  on_battle = false
  id_fight_encounter = nil
  if current_playing == true then
    if id_handler ~= nil then
      StopSound(id_handler)
      current_playing = false
      current_song.path = nil
      current_song.duration = 0
    end
  end
end

function battle_events:UNIT_AURA(unit)
  if on_battle then
    if unit == "player" then
      local time_added = time_now + current_song.duration
      local time_temp = time()
      if time_temp >= time_added then
        current_playing = false
        selecting_song()
      end
    end
  end
end

function battle_events:PLAYER_TARGET_CHANGED(typeTriggeredTarget)
  if on_battle then
    local time_added = time_now + current_song.duration
    local time_temp = time()
    if time_temp >= time_added then
      current_playing = false
      selecting_song()
    end
  end
end

-- UNIT_SPELLCAST_START

function selecting_song()
  if false then

  -- df raid boss
  elseif boss_filter(boss.eranog) then
    battle_play_file(song.boss.eranog)
  elseif boss_filter(boss.consejo_primigenio) then
    battle_play_file(song.boss.consejo_primigenio)
  elseif boss_filter(boss.sennarth_aliento_gelido) then
    battle_play_file(song.boss.sennarth_aliento_gelido)
  elseif boss_filter(boss.kurog_totem_siniestro) then
    battle_play_file(song.boss.kurog_totem_siniestro)
  elseif boss_filter(boss.raszageth_devoratormentas) then
    battle_play_file(song.boss.raszageth_devoratormentas)
  elseif boss_filter(boss.vigilante_diurna) then
    battle_play_file(song.boss.vigilante_diurna)
  elseif boss_filter(boss.dathea_ascendida) then
    battle_play_file(song.boss.dathea_ascendida)
  elseif boss_filter(boss.terros) then
    battle_play_file(song.boss.terros)

  -- df dungeon boss
  elseif boss_filter(boss.leymor) then
    battle_play_file(song.boss.leymor)
  elseif boss_filter(boss.telash_vientogris) then
    battle_play_file(song.boss.telash_vientogris)
  elseif boss_filter(boss.umbrelskul) then
    battle_play_file(song.boss.umbrelskul)
  elseif boss_filter(boss.hojazur) then
    battle_play_file(song.boss.hojazur)

  elseif boss_filter(boss.balakar_khan) then
    battle_play_file(song.boss.balakar_khan)
  elseif boss_filter(boss.teera_y_maruuk) then
    battle_play_file(song.boss.teera_y_maruuk)
  elseif boss_filter(boss.la_tempestad_iracunda) then
    battle_play_file(song.boss.la_tempestad_iracunda)
  elseif boss_filter(boss.granyth) then
    battle_play_file(song.boss.granyth)

  elseif boss_filter(boss.colmimagma) then
    battle_play_file(song.boss.colmimagma)
  elseif boss_filter(boss.senyora_guerra_sargha) then
    battle_play_file(song.boss.senyora_guerra_sargha)
  elseif boss_filter(boss.maestro_forja_gorek) then
    battle_play_file(song.boss.maestro_forja_gorek)
  elseif boss_filter(boss.magmat_azote_escamas) then
    battle_play_file(song.boss.magmat_azote_escamas)

  elseif boss_filter(boss.tiravisceras) then
    battle_play_file(song.boss.tiravisceras)
  elseif boss_filter(boss.faucefronda) then
    battle_play_file(song.boss.faucefronda)
  elseif boss_filter(boss.matriarca_descomposici√≥n_ojofurioso) then
    battle_play_file(song.boss.matriarca_descomposici√≥n_ojofurioso)
  elseif boss_filter(boss.banda_guerra_hachagarra) then
    battle_play_file(song.boss.banda_guerra_hachagarra)

  elseif boss_filter(boss.kokia_pezunya_ardiente) then
    battle_play_file(song.boss.kokia_pezunya_ardiente)
  elseif boss_filter(boss.melidrussa_tejescarcha) then
    battle_play_file(song.boss.melidrussa_tejescarcha)
  elseif boss_filter(boss.kyrakka_y_erkhart_sangre_tormentosa) then
    battle_play_file(song.boss.kyrakka_y_erkhart_sangre_tormentosa)

  elseif boss_filter(boss.vexamus) then
    battle_play_file(song.boss.vexamus)
  elseif boss_filter(boss.anciano_sin_podar) then
    battle_play_file(song.boss.anciano_sin_podar)
  elseif boss_filter(boss.graznat) then
    battle_play_file(song.boss.graznat)
  elseif boss_filter(boss.eco_de_doragosa) then
    battle_play_file(song.boss.eco_de_doragosa)

  elseif boss_filter(boss.vigia_irideus) then
    battle_play_file(song.boss.vigia_irideus)
  elseif boss_filter(boss.goliat_tragon) then
    battle_play_file(song.boss.goliat_tragon)
  elseif boss_filter(boss.khajin_la_implacable) then
    battle_play_file(song.boss.khajin_la_implacable)
  elseif boss_filter(boss.tsunami_primigenio) then
    battle_play_file(song.boss.tsunami_primigenio)

  elseif boss_filter(boss.vigia_irideus) then
    battle_play_file(song.boss.vigia_irideus)
  elseif boss_filter(boss.goliat_tragon) then
    battle_play_file(song.boss.goliat_tragon)
  elseif boss_filter(boss.khajin_la_implacable) then
    battle_play_file(song.boss.khajin_la_implacable)
  elseif boss_filter(boss.tsunami_primigenio) then
    battle_play_file(song.boss.tsunami_primigenio)

  elseif boss_filter(boss.enanos_desaparecidos) then
    battle_play_file(song.boss.enanos_desaparecidos)
  elseif boss_filter(boss.bromach) then
    battle_play_file(song.boss.bromach)
  elseif boss_filter(boss.centinela_talondras) then
    battle_play_file(song.boss.centinela_talondras)
  elseif boss_filter(boss.emberon) then
    battle_play_file(song.boss.emberon)
  elseif boss_filter(boss.cronolord_deios) then
    battle_play_file(song.boss.cronolord_deios)
  
  -- sl raid boss
  elseif boss_filter(boss.guardian_vigilante) then
    battle_play_file(song.boss.guardian_vigilante)
  elseif boss_filter(boss.dausegne_oraculo_caida) then
    battle_play_file(song.boss.dausegne_oraculo_caida)
  elseif boss_filter(boss.artificiero_xymox) then
    battle_play_file(song.boss.artificiero_xymox)
  elseif boss_filter(boss.panteon_prototipo) then
    battle_play_file(song.boss.panteon_prototipo)
  elseif boss_filter(boss.skolex_devorador_insaciable) then
    battle_play_file(song.boss.skolex_devorador_insaciable)
  elseif boss_filter(boss.halondrus_recolector) then
    battle_play_file(song.boss.halondrus_recolector)
  elseif boss_filter(boss.lihuvim_arquitecto_principal) then
    battle_play_file(song.boss.lihuvim_arquitecto_principal)
  elseif boss_filter(boss.anduin_wrynn) then
    battle_play_file(song.boss.anduin_wrynn)
  elseif boss_filter(boss.senyores_terror) then
    battle_play_file(song.boss.senyores_terror)
  elseif boss_filter(boss.rygelon) then
    battle_play_file(song.boss.rygelon)
  elseif boss_filter(boss.carcelero) then
    battle_play_file(song.boss.carcelero)

  -- sl dungeon boss
  elseif boss_filter(boss.oasis_myza) then
    battle_play_file(song.boss.oasis_myza)
  elseif boss_filter(boss.soazmi) then
    battle_play_file(song.boss.soazmi)
  elseif boss_filter(boss.hylbrande) then
    battle_play_file(song.boss.hylbrande)
  elseif boss_filter(boss.capitana_colagarfio) then
    battle_play_file(song.boss.capitana_colagarfio)
  elseif boss_filter(boss.soleah) then
    battle_play_file(song.boss.soleah)

  -- bfa raid boss
  elseif boss_filter(boss.jaina) then
    battle_play_file(song.boss.jaina)

  -- bfa dungeon boss
  elseif boss_filter(boss.sethraliss) then
    battle_play_file(song.boss.sethraliss)

  -- legion raid boss
  -- legion dungeon boss
  elseif boss_filter(boss.cordana) then
    battle_play_file(song.boss.cordana)

  elseif boss_filter(boss.archidruida_glaidalis) then
    battle_play_file(song.boss.archidruida_glaidalis)
  elseif boss_filter(boss.corazon_de_roble) then
    battle_play_file(song.boss.corazon_de_roble)
  elseif boss_filter(boss.dresaron) then
    battle_play_file(song.boss.dresaron)
  elseif boss_filter(boss.sombra_de_xavius) then
    battle_play_file(song.boss.sombra_de_xavius)

  elseif boss_filter(boss.hymdall) then
    battle_play_file(song.boss.hymdall)
  elseif boss_filter(boss.hyrja) then
    battle_play_file(song.boss.hyrja)
  elseif boss_filter(boss.fenryr) then
    battle_play_file(song.boss.fenryr)
  elseif boss_filter(boss.rey_divino_skovald) then
    battle_play_file(song.boss.rey_divino_skovald)
  elseif boss_filter(boss.odyn_salones) then
    battle_play_file(song.boss.odyn_salones)

  elseif boss_filter(boss.capitan_patrulla_gerdo) then
    battle_play_file(song.boss.capitan_patrulla_gerdo)
  elseif boss_filter(boss.talixae_corona_fuego) then
    battle_play_file(song.boss.talixae_corona_fuego)
  elseif boss_filter(boss.consejero_melandrus) then
    battle_play_file(song.boss.consejero_melandrus)

  -- wod raid boss
  -- wod dungeon boss
  elseif boss_filter(boss.sadana_furia_sangrienta) then
    battle_play_file(song.boss.sadana_furia_sangrienta)
  elseif boss_filter(boss.quijahueso) then
    battle_play_file(song.boss.quijahueso)
  elseif boss_filter(boss.ner_zhul_cementerio) then
    battle_play_file(song.boss.ner_zhul_cementerio)
  elseif boss_filter(boss.nhallish) then
    battle_play_file(song.boss.nhallish)

  -- mists raid boss
  -- mists dungeon boss
  elseif boss_filter(boss.liu_corazon_llameante) then
    battle_play_file(song.boss.liu_corazon_llameante)
  elseif boss_filter(boss.eremita_senda_petrea) then
    battle_play_file(song.boss.eremita_senda_petrea)
  elseif boss_filter(boss.maro_el_sabio) then
    battle_play_file(song.boss.maro_el_sabio)
  elseif boss_filter(boss.sha_de_la_duda) then
    battle_play_file(song.boss.sha_de_la_duda)

  -- df dungeon
  elseif instance_filter(instance.boveda_azur.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.boveda_azur)
    else
      battle_play_file(song.instance.boveda_azur)
    end
  elseif instance_filter(instance.ataque_nokhud.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.ataque_nokhud)
    else
      battle_play_file(song.instance.ataque_nokhud)
    end
  elseif instance_filter(instance.neltharus.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.neltharus)
    else
      battle_play_file(song.instance.neltharus)
    end
  elseif instance_filter(instance.hondonada_frondacuero.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.hondonada_frondacuero)
    else
      battle_play_file(song.instance.hondonada_frondacuero)
    end
  elseif instance_filter(instance.estanques_vida_rubi.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.estanques_vida_rubi)
    else
      battle_play_file(song.instance.estanques_vida_rubi)
    end
  elseif instance_filter(instance.academia_algethar.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.academia_algethar)
    else
      battle_play_file(song.instance.academia_algethar)
    end
  elseif instance_filter(instance.salas_de_infusion.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.salas_de_infusion)
    else
      battle_play_file(song.instance.salas_de_infusion)
    end
  elseif instance_filter(instance.uldaman_legado_tyr.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.uldaman_legado_tyr)
    else
      battle_play_file(song.instance.uldaman_legado_tyr)
    end
  -- df raid
  elseif instance_filter(instance.boveda_encarnaciones.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.boveda_encarnaciones)
    else
      battle_play_file(song.instance.boveda_encarnaciones)
    end

  -- sl dungeon
  elseif instance_filter(instance.peste_abrumadora.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.peste_abrumadora)
    else
      battle_play_file(song.instance.peste_abrumadora)
    end
  elseif instance_filter(instance.teatro_dolor.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.teatro_dolor)
    else
      battle_play_file(song.instance.teatro_dolor)
    end
  elseif instance_filter(instance.destruccion_necrotica.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.destruccion_necrotica)
    else
      battle_play_file(song.instance.destruccion_necrotica)
    end
  elseif instance_filter(instance.profundidades_sanguineas.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.profundidades_sanguineas)
    else
      battle_play_file(song.instance.profundidades_sanguineas)
    end
  elseif instance_filter(instance.salones_expiacion.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.salones_expiacion)
    else
      battle_play_file(song.instance.salones_expiacion)
    end
  elseif instance_filter(instance.torres_ascencion.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.torres_ascencion)
    else
      battle_play_file(song.instance.torres_ascencion)
    end
  elseif instance_filter(instance.el_otro_lado.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.el_otro_lado)
    else
      battle_play_file(song.instance.el_otro_lado)
    end
  elseif instance_filter(instance.tirna_scithe.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.tirna_scithe)
    else
      battle_play_file(song.instance.tirna_scithe)
    end
  elseif instance_filter(instance.torghast.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.torghast)
    else
      battle_play_file(song.instance.torghast)
    end
  elseif instance_filter(instance.tazavesh.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.tazavesh)
    else
      battle_play_file(song.instance.tazavesh)
    end
  -- sl raid
  elseif instance_filter(instance.castillo_nathria.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.castillo_nathria)
    else
      battle_play_file(song.instance.castillo_nathria)
    end
  elseif instance_filter(instance.sagrario_dominacion.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.sagrario_dominacion)
    else
      battle_play_file(song.instance.sagrario_dominacion)
    end
  elseif instance_filter(instance.sepulcro_primeros.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.sepulcro_primeros)
    else
      battle_play_file(song.instance.sepulcro_primeros)
    end
  
  -- bfa dungeon
  elseif instance_filter(instance.mansion_tarjasenda.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.mansion_tarjasenda)
    else
      battle_play_file(song.instance.mansion_tarjasenda)
    end
  elseif instance_filter(instance.filon.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.filon)
    else
      battle_play_file(song.instance.filon)
    end
  elseif instance_filter(instance.templo_sethraliss.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.templo_sethraliss)
    else
      battle_play_file(song.instance.templo_sethraliss)
    end
  elseif instance_filter(instance.bardoma.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.bardoma)
    else
      battle_play_file(song.instance.bardoma)
    end
  elseif instance_filter(instance.puerto_libre.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.puerto_libre)
    else
      battle_play_file(song.instance.puerto_libre)
    end
  elseif instance_filter(instance.santuario_tormenta.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.santuario_tormenta)
    else
      battle_play_file(song.instance.santuario_tormenta)
    end
  -- bfa raid
  elseif instance_filter(instance.dazaralor.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.dazaralor)
    else
      battle_play_file(song.instance.dazaralor)
    end

  -- legion dungeon
  elseif instance_filter(instance.salones_del_valor.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.salones_del_valor)
    else
      battle_play_file(song.instance.salones_del_valor)
    end
  elseif instance_filter(instance.corte_de_estrellas.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.corte_de_estrellas)
    else
      battle_play_file(song.instance.corte_de_estrellas)
    end
  -- legion raid

  -- wod dungeon
  elseif instance_filter(instance.cementerios_sombraluna.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.cementerios_sombraluna)
    else
      battle_play_file(song.instance.cementerios_sombraluna)
    end
  -- wod raid

  -- mists dungeon
  elseif instance_filter(instance.templo_dragon_jade.instanceID) then
    if is_boss() then
      battle_play_file(song.boss.templo_dragon_jade)
    else
      battle_play_file(song.instance.templo_dragon_jade)
    end
  -- mists raid

  elseif is_boss() then
    battle_play_file(song.boss.default_boss)

  else
    battle_play_file(song.default)
  end
end

function instance_filter(instance_id)
  local _, _name, _instanceType, _difficultyIndex, _difficultyName, _maxPlayers, _dynamicDifficulty, _isDynamic, instanceMapId, _instanceGroupSize, _LfgDungeonID = pcall(GetInstanceInfo)
  if instance_id == instanceMapId then
    return true
  end
  return false
end

function boss_filter(boss_npc)
  local boss_id = boss_npc.npc_id
  local boss_encounter_id = boss_npc.encounterID
  
  if boss_encounter_id == id_fight_encounter then
    return true
  end
  
  for i = 1, 4 do
    local _, guid = pcall(UnitGUID, "boss" .. i)
    if guid ~= nil then
      local _type, _zero, _server_id, _instance_id, _zone_uid, npc_id, _spawn_uid = strsplit("-", guid)
      npc_id = tonumber(npc_id)
      if boss_id == npc_id then
        return true
      end
    end
  end

  local _, guid = pcall(UnitGUID, "target")
  if guid ~= nil then
    local _type, _zero, _server_id, _instance_id, _zone_uid, npc_id, _spawn_uid = strsplit("-", guid)
    npc_id = tonumber(npc_id)
    if boss_id == npc_id then
      return true
    end
  end

  for i = 1, 4 do
    local _, guid = pcall(UnitGUID, "party" .. i .. "target")
    if guid ~= nil then
      local _type, _zero, _server_id, _instance_id, _zone_uid, npc_id, _spawn_uid = strsplit("-", guid)
      npc_id = tonumber(npc_id)
      if boss_id == npc_id then
        return true
      end
    end
  end

  return false
end

function is_boss()
  for i = 1, 4 do
    local _, boss_detected = pcall(UnitExists, "boss" .. i)
    if ( boss_detected == true or boss_detected == 1 ) then
      boss_fight = true
      return true
    end
  end
  
  for i = 1, 5 do
    local _, friend_detected = pcall(UnitExists, friend_units[i])
    if ( friend_detected == true or friend_detected == 1 ) then
      local _, type_boss = pcall(UnitClassification, friend_units[i] .. "target")
      if ( type_boss == "worldboss" ) then
        boss_fight = true
        return true
      end
    end
  end
  
  if boss_fight == true then
    return true
  end

  return false
end

function battle_play_file(song)
  if current_playing == false then
    is_played, id_handler = PlaySoundFile(song.path, "Music")
    if is_played ~= true then
      id_handler = nil
    else
      current_playing = true
      current_song.path = song.path
      current_song.duration = song.duration
      time_now = time()
    end
  end
end

for k, _v in pairs(battle_events) do
  battle_music:RegisterEvent(k) -- Register all events for which handlers have been defined
end
